"use strict";window.g={},window.g.i=Object.keys(window.SESSION_QUESTIONS).map(function(i){return parseInt(i)}),window.g.o=window.g.i.map(function(i){return window.SESSION_QUESTIONS[i]}).sort(function(i,o){return i-o}),window.g.t=window.g.i.length,window.g.s=null,window.g.l=null,window.g.u=null,window.g.h=null,window.g.p=!1,window.g.m=null,-1!=window.g.o.indexOf(null)?window.g.i=window.g.i.sort(function(i,o){return window.SESSION_QUESTIONS[i]-window.SESSION_QUESTIONS[o]}):window.g.i=window.g.i.sort(function(i,o){return i-o}),showdown.setOption("headerLevelStart",3),showdown.setOption("simpleLineBreaks",!0);var w=new showdown.Converter;function t(i){i?window.g.k.addClass("marked"):window.g.k.removeClass("marked")}function d(i,o){if(window.g.v=$('#question-pool [data-question-sequence="'+i+'"]'),window.g.v.length?(o?history.replaceState({url:window.g.v.data("url")},"",window.g.v.data("url")):history.pushState({url:window.g.v.data("url")},"",window.g.v.data("url")),_paq.push(["setCustomUrl",window.location.href])):window.g.v=$('#question-pool [data-url="'+i+'"]'),window.g.v.find(".lazy").each(function(){var i=$(this),o=i.data("src"),n=i.data("img-class"),e=$('<img class="d-none '+n+'" src="'+o+'">');e.on("load",function(){i.remove(),$(this).removeClass("d-none")}),i.after(e)}),window.g.v.length){window.g.v.addClass("show"),$(".question-body").not(window.g.v).removeClass("show"),window.g.q=window.g.v.data("question-sequence"),$("#question-sequence").html(window.g.q);var n=window.g.v.data("list-revision-url");$("#question-pk").html(window.g.v.data("question-pk")).attr("href",n),y();var e=50*Math.floor(window.g.q/50),t=50*(Math.floor(window.g.q/50)+1),s=50*(Math.floor(window.g.q/50)-1),a=e-1;t>=window.g.t&&(t=null),s<0&&(s=null),o&&j(e),(o&&t&&window.g.q>=t-10||!o&&t&&window.g.q==t-10)&&j(t),(o&&null!==s&&window.g.q<=a+10||!o&&null!==s&&window.g.q==a+10)&&j(s)}else{j(50*Math.floor(i/50),i)}}function a(){var i=$(this).data("action");if(1==window.g.q&&"previous"==i)return $("#question-sequence").addClass("animated flash").css("color","yellow"),void $("#question-sequence").one(window.g._,function(){$(this).removeClass().css("color","")});if(window.g.q==window.g.t&&"next"==i)return $("#question-total").addClass("animated flash").css("color","yellow"),void $("#question-total").one(window.g._,function(){$(this).removeClass().css("color","")});if("next"==i)var o=window.g.q+1;else if("previous"==i)o=window.g.q-1;if(window.g.v=$("#question-pool [data-question-sequence="+o+"]"),!window.g.v.length)return _paq.push(["trackEvent","show_session","navigation","navigate-unloaded"]),toastr.warning("You're super fast, "+window.USER_FIRST_NAME+"!  Give us a second to bring question #"+o.toString()+"."),void $("#question-loading").addClass("animated flash").css("color","yellow");$(".check, .answer-correction-notification, .opposing-users, .supporting-users").tooltip("hide"),d(o)}function c(){window.IS_SHARED&&"EXPLAINED"!=!window.SESSION_MODE&&$.ajax({url:Urls["exams:toggle_sharing_results"](),type:"POST",data:{session_pk:window.SESSION_PK},cache:!1,success:function(i){if(i.share_results){var o,n=[];if($(".sharer-name").each(function(){$(this).closest(".shared-session").find(".progress").data("pk")!=window.SESSION_PK&&n.push(this.innerHTML)}),1<n.length){var e=n.pop();o=n.join(", ")+" and "+e}else o=n[0];toastr.success("Sharing the results of this session with "+o+" has been enabled."),_paq.push(["trackEvent","show_session","share-results","enable-sharing"])}else toastr.success("Sharing the results of this session has been disabled."),_paq.push(["trackEvent","show_session","share-results","disable-sharing"])}})}function r(){$("#mark-icon").hide(),$("#mark-loading").css("display","inline-block"),$.ajax({url:Urls["exams:toggle_marked"](),type:"POST",data:{session_pk:window.SESSION_PK,question_pk:window.g.v.data("question-pk")},cache:!1,success:function(i){var o=window.g.v.data("question-pk"),n=window.g.l.indexOf(o);if(window.g.v.data("is-marked",i.is_marked),t(i.is_marked),i.is_marked?(-1==n&&window.g.l.push(o),_paq.push(["trackEvent","show_session","mark-question","add-mark"])):(-1!=n&&window.g.l.slice(n,1),_paq.push(["trackEvent","show_session","mark-question","remove-mark"])),window.g.p){var e=$('.navigate-row[data-question-sequence="'+window.g.q+'"]');i.is_marked?(e.find("td.is_marked").html(window.g.U),L()&&FontAwesome.dom.i2svg({node:document.getElementById("navigation-table")})):e.find("td.is_marked").html("")}$("#mark-icon").show(),$("#mark-loading").hide()}})}function o(){var i=$(this);if(i.is(":checked")){var o=i.closest(".question-body").find(".question-choice").not(i);i.closest("tr").find(".choice-text.strike").length&&(i.closest("tr").find(".choice-text.strike").removeClass("strike"),x()),o.prop("checked",!1)}else i.prop("checked",!1)}function l(){$(this).contents().unwrap(),x()}function u(){var i=$(this).closest(".selection-hint").data("text");if(3<=i.length){var o=$("<div>").text(i).html(),n=$("<span></span>").addClass("highlight").html(i).prop("outerHTML"),e=window.g.v.find(".question-text");e.html(e.html().replace(o,n)),x(),s()}}function n(i){return 3===(i=i||window.event).which||2===i.button||!1}window.g.k=$("#mark"),window.g.S=$("#submit"),window.g.P=[],window.g.O={},window.g._="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",window.g.A='<i class="far fa-check-square"></i>',window.g.U='<i class="fas fa-flag"></i>',window.g.M='<i class="fas fa-times text-danger mx-1"></i>',window.g.T=null!=navigator.userAgent.match(/iPad/i)||null!=navigator.userAgent.match(/Android/i)&&null==navigator.userAgent.match(/Mobile/i),window.g.I=null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/Android/i)&&null!=navigator.userAgent.match(/Mobile/i),toastr.options.positionClass="toast-top-left",toastr.options.preventDuplicates=!0;var h={mouse:{},isVisible:!(window.onpopstate=function(i){i.state&&d(i.state.url)})};function e(i,o){var n=h.mouse.top-60,e=h.mouse.left+(o.clientX-h.mouse.left)/2,t="",s=encodeURIComponent(i);if((window.SESSION_IS_EXAMINABLE&&!window.g.v.data("was-solved")||!window.SESSION_IS_EXAMINABLE)&&(t+='<i class="rounded py-2 fas fa-highlighter highlight-selection"></i>'),i.length<=40&&(t+='<a class="d-inline-block" target="_blank" href="https://duckduckgo.com/?q='+s+'"><i class="rounded py-2 fas fa-globe duckduckgo"></i></a>',t+='<a class="d-inline-block" target="_blank" href="https://en.wikipedia.org/wiki/Special:Search/'+s+'"><i class="rounded py-2 fab fa-wikipedia-w wikipedia"></i></a>'),-1==i.indexOf(" ")&&(t+='<a class="d-inline-block" target="_blank" href="https://en.wiktionary.org/wiki/Special:Search/'+s+'"><i class="rounded py-2 fas fa-language wiktionary"></i></a>'),t.length){var a=$('<p class="selection-hint">'+t+"</p>");a.attr("data-text",i),$("body").append(a),$(".selection-hint").css({position:"absolute",top:n,left:e})}}function s(){$(".selection-hint").remove(),document.getSelection().removeAllRanges()}function p(i,o){var n=$(".question-body tr"+("[data-choice-pk="+o+"]"));n.data("has-correction",!0).attr("data-has-correction","true"),n.find(".check").html('<i class="fas fa-exclamation-triangle text-warning answer-correction-notification mx-1"></i>'+i)}function initializeMnemonicInteractions(){var t=window.g.v.data("question-pk");window.g.v.find(".mnemonic").each(function(){var i=$(this);i.data("submitter-pk")==window.USER_PK&&(i.find(".like-mnemonic").attr("disabled",!0),i.find(".delete-mnemonic").removeClass("d-none"))}),window.g.v.find(".like-mnemonic").off("click").on("click",function(){var i=$(this),o=i.data("action"),n=i.closest(".mnemonic").data("mnemonic-pk"),e=Urls["exams:contribute_mnemonics"]()+"?"+$.param({question_pk:t});$.ajax({url:e,type:"POST",data:{action:o,mnemonic_pk:n},success:function(i){1==i.success?(toastr.success("Your vote was submitted."),window.g.v.find(".mnemonics-content").html(i.mnemonic_html),initializeMnemonicInteractions()):toastr.error(i.message)}})}),window.g.v.off("click",".delete-mnemonic").on("click",".delete-mnemonic",function(){var i=$(this),o=i.data("action"),n=i.closest(".mnemonic").data("mnemonic-pk"),e=Urls["exams:contribute_mnemonics"]()+"?"+$.param({question_pk:t});$.ajax({url:e,type:"POST",data:{action:o,mnemonic_pk:n},success:function(i){1==i.success?(toastr.success("Your mnemonic is deleted."),window.g.v.find(".mnemonics-content").html(i.mnemonic_html),initializeMnemonicInteractions()):toastr.error(i.message)}})})}function f(){window.g.v.off("click",".correct [data-fa-i2svg]").on("click",".correct [data-fa-i2svg]",function(){_paq.push(["trackEvent","show_session","answer_correction","click-correct"]),$("#correct-answer-modal").modal("show");var i=$(this).closest("tr").data("choice-pk"),o=Urls["exams:correct_answer"]()+"?"+$.param({choice_pk:i});$("#correct-answer-modal .modal-body").load(o)})}function m(){var i=window.g.v.find(".explanation-text").length||window.g.v.find(".explanation-figure").length||window.g.v.find(".explanation-reference-header").length,o=window.g.v.data("was-solved"),n=window.g.v.find(".explanation-container");!o||"UNEXPLAINED"==window.SESSION_MODE&&!$("body").data("has-finished")?(n.hide(),$("#explain").hide()):i?(n.show(),$("#explain").show().html('<i class="fas fa-cubes"></i> Improve this explanation!')):(n.hide(),$("#explain").show().html("Add an explanation!"))}function k(){var i=window.g.v.data("was-solved"),o=window.g.v.find(".mnemonic").length;!i||"UNEXPLAINED"==window.SESSION_MODE&&!$("body").data("has-finished")?$(".mnemonics-container, #add-mnemonics").hide():o?($("#add-mnemonics").show().html('<i class="fas fa-book"></i> Add another mnemonic!'),$(".mnemonics-container").show()):($(".mnemonics-container").hide(),$("#add-mnemonics").show().html('<i class="fas fa-book"></i> Add the first mnemonic!'))}function v(){window.g.u&&Object.keys(window.g.u).length>=window.g.t&&$("body").data("has-finished",!0).attr("data-has-finished","true")}function q(){if(!window.g.T){if($("#next").tooltip("dispose"),window.g.q==window.g.t){$("#next").css("cursor","not-allowed");var i=$("#end:visible, #results:visible").html();$("#next").tooltip({title:"This is the last question.  You can click <kbd>"+i+"</kbd> to end this session.",html:!0})}else $("#next").tooltip(),$("#next").css("cursor","pointer");1==window.g.q?$("#previous").css("cursor","not-allowed"):$("#previous").css("cursor","pointer")}}function b(){var i=$('.navigate-row[data-question-sequence="'+window.g.q+'"]');i.addClass("table-active"),$(".navigate-row").not(i).removeClass("table-active")}function _(){window.g.v.off("click",".highlight"),window.g.v.find(".choice-text").off("click"),window.g.v.find(".question-text").off("mouseup touchend")}function y(){window.g.v.find('[data-toggle="tooltip"]').tooltip(),f(),initializeMnemonicInteractions(),q(),t(window.g.v.data("is-marked")),window.g.p&&b(),$("#contributors").tooltip("dispose"),$("#contributors").off("click").click(function(){_paq.push(["trackEvent","show_session","see-contributors","see-contributors"])}),$("#contributors").tooltip({html:!0,trigger:"click",title:window.g.v.find(".tooltip-body").get(0)}),m(),k();var i=window.g.v.data("was-solved");i?($("#contribute,#add-mnemonics").show(),window.g.S.hide(),window.g.v.find(".question-choice").prop("disabled","disabled")):($("#contribute,#add-mnemonics").hide(),window.g.S.show(),window.g.v.find(".question-choice").off("change").on("change",o)),window.SESSION_IS_EXAMINABLE&&!i||!window.SESSION_IS_EXAMINABLE?window.g.v.find(".choice-text").off("click").on("click",function(){$(this).hasClass("strike")||$(this).closest("tr").find(".question-choice").prop("checked",!1).trigger("change"),$(this).toggleClass("strike"),x()}):_()}function x(){var i=window.g.v.find(".choice-text.strike").map(function(){return $(this).closest("tr").data("choice-pk")}).get();i=JSON.stringify(i);var o={best_revision_pk:window.g.v.data("best-latest-revision-pk"),highlighted_text:window.g.v.find(".question-text").html(),stricken_choice_pks:i,session_pk:window.SESSION_PK,question_pk:window.g.v.data("question-pk")};$.ajax({url:Urls["exams:submit_highlight"](),type:"POST",data:o})}function E(){if($(this).hide(),!window.g.v.data("was-solved")){if(window.g.v.data("was-solved",!0).attr("data-was-solved","true"),window.g.p)$('.navigate-row[data-question-sequence="'+window.g.q+'"]').find("td.was_solved").html(window.g.A),L()&&FontAwesome.dom.i2svg({node:document.getElementById("navigation-table")});window.g.v.find(".question-choice").prop("disabled","disabled"),m(),k(),_(),$("#contribute,#add-mnemonics").show(),window.g.v.find(".question-text, .question-choice, .choice-text").off();var i=window.g.v.find(".question-choice:checked");if(i.length){var o=i.closest("tr"),n=o.data("choice-pk");o.data("is_right")?window.g.h.correct_count+=1:window.g.h.incorrect_count+=1;var e=o.find(".answer-correction-notification"),t=o.find("button.support-correction:enabled");e.length&&t.length&&(o.find(".check").tooltip({template:'<div class="tooltip hint" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',html:!0,title:"<strong>Are you sure that this is the right answer?</strong>  Vote to support this correction! <img height='17' src='https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/png/1f64a.png'>",placement:"right",trigger:"manual"}).tooltip("show"),setTimeout(function(){o.find(".check").tooltip("hide")},5e3))}else{window.g.h.skipped_count+=1;n=null}I(window.SESSION_PK,window.g.h);var s=window.g.v.data("question-pk");window.g.u[s]=n,v();var a={session_pk:window.SESSION_PK,question_pk:s,choice_pk:n};$.ajax({url:Urls["exams:submit_answer"](),type:"POST",data:a,cache:!1,success:function(i){i.success?n||toastr.warning("You skipped this question"):toastr.error(i.message)}})}}function U(){var i=$("#container").height()-$("#top-info").height()-$("#top-options").height();$("#question-row").css({"padding-bottom":$("#footer").height(),"min-height":i})}function S(){$(document).keydown(function(i){if(window.g.O[i.which]=!0,window.g.O[37])$("#previous").trigger("click"),_paq.push(["trackEvent","show_session","navigation","keyboard-previous"]);else if(window.g.O[39]||window.g.O[32])i.preventDefault(),$("#next").trigger("click"),_paq.push(["trackEvent","show_session","navigation","keyboard-next"]);else if(window.g.O[18]&&window.g.O[77])_paq.push(["trackEvent","show_session","mark-question","keyboard-mark"]),window.g.k.trigger("click");else if(window.g.O[18]&&window.g.O[85]){if(_paq.push(["trackEvent","show_session","find-pending","keyboard-pending"]),"SOLVED"==window.SESSION_MODE||"INCOMPLETE"==window.SESSION_MODE)return;var o=$(".question-body[data-was-solved=false]").data("question-sequence");o?d(o):toastr.success("Yay!  No pending in this session.")}else if(window.g.O[17]&&window.g.O[13])_paq.push(["trackEvent","show_session","mark-question","keyboard-submit"]),window.g.S.trigger("click");else{if(!(window.g.O[17]&&window.g.O[38]||window.g.O[17]&&window.g.O[40]))return;i.preventDefault();var n=window.g.v.find(".question-choice").length,e=window.g.v.find(".question-choice:enabled:checked");if(e.length){var t=window.g.v.find(".question-choice").index(e);if(window.g.O[38]&&0==t)return;if(window.g.O[40]&&t==n-1)return;if(window.g.O[40]){_paq.push(["trackEvent","show_session","navigation","keyboard-down"]);var s=t+1}else if(window.g.O[38]){_paq.push(["trackEvent","show_session","navigation","keyboard-up"]);s=t-1}}else s=0;var a=window.g.v.find(".question-choice:enabled").get(s);$(a).prop("checked",!0).trigger("change")}}),$(document).keyup(function(i){delete window.g.O[i.which]})}function P(){$("#navigate-modal").modal({show:!1}),$("#open-navigation").off("click").click(function(){_paq.push(["trackEvent","show_session","navigation","open-navigation"]),$("#navigate-modal").modal("show")}),$("#navigate-modal").on("shown.bs.modal",function(){$(this).animate({scrollTop:$(".navigate-row.table-active").position().top},500)});for(var i=document.getElementById("navigation-tbody"),o="",n=1;n<=window.g.i.length;n++){var e=n-1,t=window.g.i[e],s=void 0!==window.g.u[t]?window.g.A:'<i class="far fa-square"></i>';if(window.g.l)var a=-1!=window.g.l.indexOf(t)?window.g.U:"";o+="<tr class='navigate-row text-center' data-question-sequence='"+n.toString()+"'><td>"+n.toString()+"</td><td class='d-sm-table-cell d-none'>"+t.toString()+"</td><td class='d-sm-table-cell d-none is_marked'>"+a+"</td><td class='was_solved'>"+s+"</td></tr>"}i.innerHTML=o,L()&&FontAwesome.dom.i2svg({node:document.getElementById("navigation-table")}),$("#navigation-table").find(".navigate-row").click(function(){_paq.push(["trackEvent","show_session","navigation","click-navigate-row"]),d($(this).data("question-sequence"))}),b(),window.g.p=!0}function O(){$.ajax({method:"get",url:Urls["answer-list"](),data:{format:"json",session_pk:window.SESSION_PK},success:function(i){window.g.u={},window.g.h={correct_count:0,incorrect_count:0,skipped_count:0},i.map(function(i){null===i.choice?(window.g.h.skipped_count+=1,window.g.u[i.question_id]=null):!0===i.choice.is_right?(window.g.h.correct_count+=1,window.g.u[i.question_id]=i.choice.id):!1===i.choice.is_right&&(window.g.h.incorrect_count+=1,window.g.u[i.question_id]=i.choice.id)}),D($(".question-body")),v(),I(window.SESSION_PK,window.g.h),y(),$("#open-navigation").tooltip("dispose").css("cursor","pointer").click(function(){P(),$(this).trigger("click")})}})}function A(){$.ajax({method:"get",url:Urls["marked-list"](),data:{format:"json",exam_pk:window.EXAM_PK},success:function(i){window.g.l=i.map(function(i){return i.id}),$(".question-body").each(function(){var i=$(this);C(i,i.data("question-pk"))})}})}function M(){$.ajax({method:"get",url:Urls["highlight-list"](),data:{format:"json",session_pk:window.SESSION_PK},success:function(i){window.g.s={},i.map(function(i){window.g.s[i.revision.question_id]={revision_id:i.revision.id,highlighted_text:i.highlighted_text,stricken_choices:i.stricken_choices}}),$(".question-body").each(function(){N($(this))})}})}function T(){$.ajax({method:"get",url:Urls["exams:get_shared_session_stats"](),data:{format:"json",session_pk:window.SESSION_PK},success:function(i){if(i.success){for(var o in i.stats){var n=i.stats[o];I(n.pk,n)}$('.progress[data-has-finished="false"]').length||F()}else toastr.error(i.message)}})}function I(i,o){if(window.IS_SHARED){var n=$('.progress[data-pk="'+i+'"]');if(i!=window.SESSION_PK?n.attr("data-has-finished",o.has_finished.toString()):i==window.SESSION_PK&&"EXPLAINED"!=window.SESSION_MODE&&(o.count=o.correct_count+o.incorrect_count+o.skipped_count),o.count){var e=o.count/window.g.t*100+"%";n.html('<div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="'+o.count+'" style="width: '+e+'"></div>'),$("#shared-session-"+i).tooltip({html:!0,title:'<span class="sharer-name">'+o.count+" out of "+window.g.t+" questions ("+e+")</span>"})}else{var t=Math.round(o.correct_count/window.g.t*100)+"%",s=Math.round(o.incorrect_count/window.g.t*100)+"%",a=Math.round(o.skipped_count/window.g.t*100)+"%";n.html('<div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="'+o.correct_count+'" style="width: '+t+'"></div><div class="progress-bar bg-danger" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="'+o.incorrect_count+'" style="width: '+s+'"></div><div class="progress-bar bg-warning" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="'+o.skipped_count+'" style="width: '+a+'"></div>'),$("#shared-session-"+i).tooltip({html:!0,title:'<ul class="mb-0 pl-3 sharer-name"><li>Correct: '+o.correct_count+" ("+t+")</li><li>Incorrect: "+o.incorrect_count+" ("+s+")</li><li>Skipped: "+o.skipped_count+" ("+a+")</li></ul>"})}}}function L(){return(-1!=navigator.userAgent.indexOf("iPhone")||-1!=navigator.userAgent.indexOf("iPad"))&&-1!=navigator.userAgent.indexOf("OS 9_")||-1!=navigator.userAgent.indexOf("Mac OS")&&-1!=navigator.userAgent.indexOf("Version/9")&&-1!=navigator.userAgent.indexOf("Safari/")}function j(e,t){if(-1==window.g.P.indexOf(e)){var s=window.g.i.slice(e,e+50),a=s.join(",");$("#question-loading").show(),$.ajax({method:"get",url:Urls["exams:list_partial_session_questions"](window.CATEGORY_SLUGS,window.EXAM_PK),data:{pks:a},success:function(i){window.g.P.push(e);var o=$(i.html);if(-1!=s.indexOf(window.g.L))var n=o.filter(function(){return $(this).data("question-pk")!=window.g.L});else n=o;D(n),$("#question-pool").append(n),$.ajax({method:"get",url:Urls["correction-list"](),data:{format:"json",exam_pk:window.EXAM_PK,question_pks:a},success:function(i){$.each(i,function(i,o){p(o.html,o.choice_id)})}}),L()&&FontAwesome.dom.i2svg({node:document.getElementById("question-pool")}),t&&d(t),$("#question-loading").hide()}})}}function N(n){if(null!==window.g.s){var i=n.data("question-pk"),e=window.g.s[i];if(void 0!==e)n.data("best-latest-revision-pk")==e.revision_id&&(e.highlighted_text&&n.find(".question-text").html(e.highlighted_text),$.each(e.stricken_choices,function(i){var o=e.stricken_choices[i];n.find("tr[data-choice-pk="+o+"] .choice-text").addClass("strike")}))}}function Y(i){if(null!==window.g.u){var o=i.data("question-pk"),n=window.g.u[o];if(void 0!==n){if(i.data("was-solved",!0).attr("data-was-solved","true"),i.find(".question-choice").attr("disabled",!0),n)i.find("tr[data-choice-pk="+n+'] input[type="checkbox"]').prop("checked",!0)}else i.data("was-solved",!1).attr("data-was-solved","false");var e,t,s=i.find(".choice-table tbody"),a=s.find("tr"),d=a.length;for(a.detach();0!==d;)t=Math.floor(Math.random()*d),e=a[d-=1],a[d]=a[t],a[t]=e;s.append(a),s.removeClass("unprepared")}}function C(i,o){-1!=window.g.l.indexOf(o)?(i.data("is-marked",!0).attr("data-is-marked","true"),i.hasClass("show")&&t(!0)):i.data("is-marked",!1).attr("data-is-marked","false")}function D(i){i.each(function(){var i=$(this),o=i.data("question-pk"),n=i.find(".question-text").html(),e=i.find(".explanation-text").html(),t=w.makeHtml(n);if(i.find(".question-text").html(t),void 0!==e){var s=w.makeHtml(e);i.find(".explanation-text").html(s)}Y(i),N(i);var a=window.g.i.indexOf(o)+1;i.data("question-sequence",a).attr("data-question-sequence",a);var d=Urls["exams:list_revisions"](window.CATEGORY_SLUGS,window.EXAM_PK,o),c=Urls["exams:show_session"](window.CATEGORY_SLUGS,window.EXAM_PK,window.SESSION_PK,o);i.data("list-revision-url",d).attr("data-list-revision-url",d),i.data("url",c).attr("data-url",c),"SOLVED"!=window.SESSION_MODE&&"INCOMPLETE"!=window.SESSION_MODE||(i.data("was-solved",!0).attr("data-was-solved","true"),i.find(".question-choice").attr("disabled",!0)),window.g.l&&C(i,o)});var o=$("#question-pool");o.hasClass("choices-were-animated")||(o.addClass("choices-were-animated"),window.g.v.find("tbody").addClass("animated fadeIn").one(window.g._,function(){$(this).removeClass()}))}function V(){!window.g.m&&document.hasFocus()&&$('.progress[data-has-finished="false"]').length&&(window.g.m=setInterval(T,5e3))}function F(){window.g.m&&(clearInterval(window.g.m),window.g.m=null)}$("#question-pool").mousedown(function(i){h.mouse.top=i.clientY+window.pageYOffset,h.mouse.left=i.clientX,!n(i)&&h.isVisible&&(s(),h.isVisible=!1)}),$("#question-pool").mouseup(function(i){var o=window.getSelection().toString().trim();5<o.length&&!n(i)&&(e(o,i),h.isVisible=!0)}),window.g.T&&($(".mobile-slide").removeClass("d-lg-none"),$("#question-col").removeClass("col-lg-12 px-lg-5")),(window.g.T||window.g.I)&&$("#keyboard-hint").addClass("d-none"),window.IS_SHARED&&($(window).on("focus",function(){$('.progress[data-has-finished="false"]').length&&T(),V()}),$(window).on("blur",F)),$(function(){new ClipboardJS("#share-session-copy").on("success",function(i){_paq.push(["trackEvent","show_session","share","click-copy"]),$(i.trigger).tooltip("show"),setTimeout(function(){$(i.trigger).tooltip("hide")},1e3)});var i=$(".question-body.show");window.g.L=i.data("question-pk");var o=window.g.i.indexOf(window.g.L)+1;i.attr("data-question-sequence",o).data("question-sequence",o),d(o,!0),$("#question-total").html(window.g.t),$("#question-sequence").html(o),S(),window.g.T?$('[data-toggle="tooltip"]').not("#next, #previous, #mark").tooltip():window.g.I?$('[data-toggle="tooltip"]').not(window.g.k).tooltip():$('[data-toggle="tooltip"]').tooltip();var n=$("#help-me-tooltip").get(0);$("#help-me").tooltip({html:!0,trigger:"click",title:n}),$("#help-me").click(function(){_paq.push(["trackEvent","show_session","click-get-help","click-get-help"])});var e=$("#setting-tooltip").get(0);$("#settings").tooltip({html:!0,placement:"bottom",trigger:"click",title:e}),$("#settings").click(function(){_paq.push(["trackEvent","show_session","click-settings","click-settings"])});var t=$("#share-tooltip").get(0);$("#share").tooltip({html:!0,trigger:"click",title:t}),$("#share").click(function(){$(this).removeClass("emphasized"),_paq.push(["trackEvent","show_session","share","click-share"])}),$("#theme-select").change(function(){var i=$(this).find("option:selected");$(":root").css({"--primary-background-color":i.data("primary-background-color"),"--secondary-background-color":i.data("secondary-background-color"),"--tertiary-background-color":i.data("tertiary-background-color"),"--primary-font-color":i.data("primary-font-color"),"--secondary-font-color":i.data("secondary-font-color"),"--tertiary-font-color":i.data("tertiary-font-color"),"--highlight-background":i.data("highlight-background"),"--highlight-color":i.data("highlight-color"),"--table-active":i.data("table-active"),"--table-hover":i.data("table-hover")})}),$("#save-theme").click(function(){$.ajax({url:Urls["exams:update_session_theme"](),type:"POST",data:{session_theme_pk:$("#theme-select").val()},success:function(i){i.success?($("#settings").tooltip("hide"),toastr.success("Your theme was updated!")):toastr.error(i.message)}})}),O(),M(),A(),U(),$(window).resize(U),window.IS_SHARED&&(T(),V(),$("#share-results").change(c)),$(".mobile-slide").click(function(){$(this).hasClass("previous")?($("#previous").trigger("click"),_paq.push(["trackEvent","show_session","navigation","slide-previous"])):$(this).hasClass("next")&&($("#next").trigger("click"),_paq.push(["trackEvent","show_session","navigation","slide-next"]))}),$("#end").click(function(){$("#confirm-end-modal a.submit-button").prop("href",Urls["exams:show_session_results"](window.CATEGORY_SLUGS,window.EXAM_PK,window.SESSION_PK)),$("#confirm-end-modal").modal("show")}),window.g.S.click(E),$("#previous, #next").click(a),window.g.k.click(r),$(document).on("click",".wikipedia, .duckduckgo, .wiktionary",function(){var i=$(this).closest(".selection-hint").data("text"),o=$(this).hasClass("wikipedia")?"wikipedia":$(this).hasClass("duckduckgo")?"duckduckgo":"wiktionary";_paq.push(["trackEvent","show_session",o,i])}),$(document).on("click",".highlight-selection",u),$(document).on("click",".highlight",l),$(document).tooltip({selector:".answer-correction-notification",html:!0,trigger:"click",title:function(){var i=$(this).closest("td").find(".answer-correction-tooltip-body").clone(!0);return i.find('[data-toggle="tooltip"]').tooltip(),i.get(0)}}),$(document).on("show.bs.tooltip",".answer-correction-notification",function(){$(".answer-correction-notification").not(this).tooltip("hide"),_paq.push(["trackEvent","show_session","answer_correction","click-notification"])}),$(document).on("click",".delete-correction",function(){var o=$(this).data("choice-pk"),i=Urls["exams:delete_correction"]()+"?"+$.param({choice_pk:o}),n="[data-choice-pk="+o+"]",e=window.g.v.find("tr"+n);e.data("has-correction",!1).attr("data-has-correction","false"),$(".answer-correction-notification").tooltip("hide"),$(this).tooltip("hide"),$.ajax({url:i,type:"POST",success:function(i){1==i.success?(toastr.success("Your correction was removed."),i.correction_html?p(i.correction_html,o):e.find(".check").html(window.g.M)):toastr.error(i.message)}})}),$(document).on("click",".support-correction, .oppose-correction",function(){var i=$(this).data("action"),o=$(this).data("choice-pk"),n=Urls["exams:correct_answer"]()+"?"+$.param({choice_pk:o});_paq.push(["trackEvent","show_session","answer_correction","delete-notification"]),$.ajax({url:n,type:"POST",data:{action:i},success:function(i){1==i.success?(toastr.success("Your vote was submitted."),p(i.correction_html,o)):toastr.error(i.message)}})}),$("#modify-question-modal, #explain-question-modal,#add-mnemonics-modal").modal({keyboard:!1,backdrop:"static",show:!1}),$("#contribute").click(function(){$("#modify-question-modal").modal("show");var i=Urls["exams:contribute_revision"]()+"?"+$.param({question_pk:window.g.v.data("question-pk")});$("#modify-question-modal .modal-body").load(i)}),$("#explain, a.explain").click(function(){$("#explain-question-modal").modal("show");var i=Urls["exams:contribute_explanation"]()+"?"+$.param({question_pk:window.g.v.data("question-pk")});$("#explain-question-modal .modal-body").load(i)}),$("#add-mnemonics").click(function(){$("#add-mnemonics-modal").modal("show");var i=Urls["exams:contribute_mnemonics"]()+"?"+$.param({question_pk:window.g.v.data("question-pk")});$("#add-mnemonics-modal .modal-body").load(i)});var s="#explain-question-modal,#modify-question-modal,#correct-answer-modal,#add-mnemonics-modal";$(s).on("hidden.bs.modal",function(){S()}),$(s).on("show.bs.modal",function(){$(document).off("keydown keydup")})});
//# sourceMappingURL=show_session.min.js.map