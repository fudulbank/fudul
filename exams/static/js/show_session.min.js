window.i=Object.keys(window.SESSION_QUESTIONS).map(function(i){return parseInt(i)}),window.o=window.i.map(function(i){return window.SESSION_QUESTIONS[i]}).sort(function(i,o){return i-o}),window.t=window.i.length,window.s=null,window.l=null,window.u=null,window.h=null,window.p=!1,window.m=null,-1!=window.o.indexOf(null)?window.i=window.i.sort(function(i,o){return window.SESSION_QUESTIONS[i]-window.SESSION_QUESTIONS[o]}):window.i=window.i.sort(function(i,o){return i-o}),showdown.setOption("headerLevelStart",3),showdown.setOption("simpleLineBreaks",!0);var converter=new showdown.Converter;function handleMarked(i){i?window.g.addClass("marked"):window.g.removeClass("marked")}function showQuestion(i,o){if(window.k=$('#question-pool [data-question-sequence="'+i+'"]'),window.k.length?(o?history.replaceState({url:window.k.data("url")},"",window.k.data("url")):history.pushState({url:window.k.data("url")},"",window.k.data("url")),_paq.push(["setCustomUrl",window.location.href])):window.k=$('#question-pool [data-url="'+i+'"]'),window.k.find(".lazy").each(function(){var i=$(this),o=i.data("src"),n=i.data("img-class"),e=$('<img class="d-none '+n+'" src="'+o+'">');e.on("load",function(){i.remove(),$(this).removeClass("d-none")}),i.after(e)}),window.k.length){window.k.addClass("show"),$(".question-body").not(window.k).removeClass("show"),window.v=window.k.data("question-sequence"),$("#question-sequence").html(window.v);var n=window.k.data("list-revision-url");$("#question-pk").html(window.k.data("question-pk")).attr("href",n),initializeInteractions();var e=50*Math.floor(window.v/50),t=50*(Math.floor(window.v/50)+1),s=50*(Math.floor(window.v/50)-1),a=e-1;t>=window.t&&(t=null),s<0&&(s=null),o&&fetchList(e),(o&&t&&window.v>=t-10||!o&&t&&window.v==t-10)&&fetchList(t),(o&&null!==s&&window.v<=a+10||!o&&null!==s&&window.v==a+10)&&fetchList(s)}else{fetchList(50*Math.floor(i/50),i)}}function navigate(){var i=$(this).data("action");if(1==window.v&&"previous"==i)return $("#question-sequence").addClass("animated flash").css("color","yellow"),void $("#question-sequence").one(window.q,function(){$(this).removeClass().css("color","")});if(window.v==window.t&&"next"==i)return $("#question-total").addClass("animated flash").css("color","yellow"),void $("#question-total").one(window.q,function(){$(this).removeClass().css("color","")});if("next"==i)var o=window.v+1;else if("previous"==i)o=window.v-1;if(window.k=$("#question-pool [data-question-sequence="+o+"]"),!window.k.length)return _paq.push(["trackEvent","show_session","navigation","navigate-unloaded"]),toastr.warning("You're super fast, "+window.USER_FIRST_NAME+"!  Give us a second to bring question #"+o.toString()+"."),void $("#question-loading").addClass("animated flash").css("color","yellow");$(".check, .answer-correction-notification, .opposing-users, .supporting-users").tooltip("hide"),showQuestion(o)}function toggleMarked(){$("#mark-icon").hide(),$("#mark-loading").css("display","inline-block"),$.ajax({url:Urls["exams:toggle_marked"](),type:"POST",data:{session_pk:window.SESSION_PK,question_pk:window.k.data("question-pk")},cache:!1,success:function(i){var o=window.k.data("question-pk"),n=window.l.indexOf(o);if(window.k.data("is-marked",i.is_marked),handleMarked(i.is_marked),i.is_marked?(-1==n&&window.l.push(o),_paq.push(["trackEvent","show_session","mark-question","add-mark"])):(-1!=n&&window.l.slice(n,1),_paq.push(["trackEvent","show_session","mark-question","remove-mark"])),window.p){var e=$('.navigate-row[data-question-sequence="'+window.v+'"]');i.is_marked?(e.find("td.is_marked").html(window._),isSafari9()&&FontAwesome.dom.i2svg({node:document.getElementById("navigation-table")})):e.find("td.is_marked").html("")}$("#mark-icon").show(),$("#mark-loading").hide()}})}function toggleChoices(){var i=$(this);if(i.is(":checked")){var o=i.closest(".question-body").find(".question-choice").not(i);i.closest("tr").find(".choice-text.strike").length&&(i.closest("tr").find(".choice-text.strike").removeClass("strike"),submitHighlight()),o.prop("checked",!1)}else i.prop("checked",!1)}function removeHighlight(){$(this).contents().unwrap(),submitHighlight()}function highlightText(){var i=window.getSelection().toString();if(3<=i.length){var o=$("<div>").text(i).html(),n=$("<span></span>").addClass("highlight").html(i).prop("outerHTML");$(this).html($(this).html().replace(o,n)),window.k.off("click",".highlight").on("click",".highlight",removeHighlight),submitHighlight()}}function updateCorrectionTooltip(i,o){var n=$(".question-body tr"+("[data-choice-pk="+o+"]"));n.data("has-correction",!0).attr("data-has-correction","true"),n.find(".check").html('<i class="fas fa-exclamation-triangle text-warning answer-correction-notification mx-1"></i>'+i)}function initializeMnemonicInteractions(){var t=window.k.data("question-pk");window.k.find(".mnemonic").each(function(){var i=$(this);i.data("submitter-pk")==window.USER_PK&&(i.find(".like-mnemonic").attr("disabled",!0),i.find(".delete-mnemonic").removeClass("d-none"))}),window.k.find(".like-mnemonic").off("click").on("click",function(){var i=$(this),o=i.data("action"),n=i.closest(".mnemonic").data("mnemonic-pk"),e=Urls["exams:contribute_mnemonics"]()+"?"+$.param({question_pk:t});$.ajax({url:e,type:"POST",data:{action:o,mnemonic_pk:n},success:function(i){1==i.success?(toastr.success("Your vote was submitted."),window.k.find(".mnemonics-content").html(i.mnemonic_html),initializeMnemonicInteractions()):toastr.error(i.message)}})}),window.k.off("click",".delete-mnemonic").on("click",".delete-mnemonic",function(){var i=$(this),o=i.data("action"),n=i.closest(".mnemonic").data("mnemonic-pk"),e=Urls["exams:contribute_mnemonics"]()+"?"+$.param({question_pk:t});$.ajax({url:e,type:"POST",data:{action:o,mnemonic_pk:n},success:function(i){1==i.success?(toastr.success("Your mnemonic is deleted."),window.k.find(".mnemonics-content").html(i.mnemonic_html),initializeMnemonicInteractions()):toastr.error(i.message)}})})}function initializeCorrectionInteractions(){window.k.off("click",".correct [data-fa-i2svg]").on("click",".correct [data-fa-i2svg]",function(){_paq.push(["trackEvent","show_session","answer_correction","click-correct"]),$("#correct-answer-modal").modal("show");var i=$(this).closest("tr").data("choice-pk"),o=Urls["exams:correct_answer"]()+"?"+$.param({choice_pk:i});$("#correct-answer-modal .modal-body").load(o)})}function controlExplanation(){var i=window.k.find(".explanation-text").length||window.k.find(".explanation-figure").length||window.k.find(".explanation-reference-header").length,o=window.k.data("was-solved"),n=window.k.find(".explanation-container");!o||"UNEXPLAINED"==window.SESSION_MODE&&!$("body").data("has-finished")?(n.hide(),$("#explain").hide()):i?(n.show(),$("#explain").show().html('<i class="fas fa-cubes"></i> Improve this explanation!')):(n.hide(),$("#explain").show().html("Add an explanation!"))}function controlMnemonic(){var i=window.k.data("was-solved"),o=window.k.find(".mnemonic").length;!i||"UNEXPLAINED"==window.SESSION_MODE&&!$("body").data("has-finished")?$(".mnemonics-container, #add-mnemonics").hide():o?($("#add-mnemonics").show().html('<i class="fas fa-book"></i> Add another mnemonic!'),$(".mnemonics-container").show()):($(".mnemonics-container").hide(),$("#add-mnemonics").show().html('<i class="fas fa-book"></i> Add the first mnemonic!'))}function controlSessionFinished(){window.u&&Object.keys(window.u).length>=window.t&&$("body").data("has-finished",!0).attr("data-has-finished","true")}function controlNavigationButtons(){window.S||($("#next").tooltip("dispose"),window.v==window.t?($("#next").css("cursor","not-allowed"),button_name=$("#end:visible, #results:visible").html(),$("#next").tooltip({title:"This is the last question.  You can click <kbd>"+button_name+"</kbd> to end this session.",html:!0})):($("#next").tooltip(),$("#next").css("cursor","pointer")),1==window.v?$("#previous").css("cursor","not-allowed"):$("#previous").css("cursor","pointer"))}function highlightActiveRow(){var i=$('.navigate-row[data-question-sequence="'+window.v+'"]');i.addClass("table-active"),$(".navigate-row").not(i).removeClass("table-active")}function disableHighlightInteractions(){window.k.off("click",".highlight"),window.k.find(".choice-text").off("click"),window.k.find(".question-text").off("mouseup touchend")}function initializeInteractions(){window.k.find('[data-toggle="tooltip"]').tooltip(),initializeCorrectionInteractions(),initializeMnemonicInteractions(),controlNavigationButtons(),handleMarked(window.k.data("is-marked")),window.p&&highlightActiveRow(),$("#contributors").tooltip("dispose"),$("#contributors").off("click").click(function(){_paq.push(["trackEvent","show_session","see-contributors","see-contributors"])}),$("#contributors").tooltip({html:!0,trigger:"click",title:window.k.find(".tooltip-body").get(0)}),controlExplanation(),controlMnemonic();var i=window.k.data("was-solved");i?($("#contribute,#add-mnemonics").show(),window.M.hide(),window.k.find(".question-choice").prop("disabled","disabled")):($("#contribute,#add-mnemonics").hide(),window.M.show(),window.k.find(".question-choice").off("change").on("change",toggleChoices)),window.SESSION_IS_EXAMINABLE&&!i||!window.SESSION_IS_EXAMINABLE?(window.k.find(".question-text").off("mouseup touchend").on("mouseup touchend",highlightText),window.k.off("click",".highlight").on("click",".highlight",removeHighlight),window.k.find(".choice-text").off("click").on("click",function(){$(this).hasClass("strike")||$(this).closest("tr").find(".question-choice").prop("checked",!1).trigger("change"),$(this).toggleClass("strike"),submitHighlight()})):disableHighlightInteractions()}function submitHighlight(){var i=window.k.find(".choice-text.strike").map(function(){return $(this).closest("tr").data("choice-pk")}).get();i=JSON.stringify(i);var o={best_revision_pk:window.k.data("best-latest-revision-pk"),highlighted_text:window.k.find(".question-text").html(),stricken_choice_pks:i,session_pk:window.SESSION_PK,question_pk:window.k.data("question-pk")};$.ajax({url:Urls["exams:submit_highlight"](),type:"POST",data:o})}function submitChoice(){if($(this).hide(),!window.k.data("was-solved")){if(window.k.data("was-solved",!0).attr("data-was-solved","true"),window.p)$('.navigate-row[data-question-sequence="'+window.v+'"]').find("td.was_solved").html(window.T),isSafari9()&&FontAwesome.dom.i2svg({node:document.getElementById("navigation-table")});window.k.find(".question-choice").prop("disabled","disabled"),controlExplanation(),controlMnemonic(),disableHighlightInteractions(),$("#contribute,#add-mnemonics").show(),window.k.find(".question-text, .question-choice, .choice-text").off();var i=window.k.find(".question-choice:checked");if(i.length){choice_pk=i.closest("tr").data("choice-pk");var o=i.closest("tr");o.data("is_right")?window.h.correct_count+=1:window.h.incorrect_count+=1;var n=o.find(".answer-correction-notification"),e=o.find("button.support-correction:enabled");n.length&&e.length&&(o.find(".check").tooltip({template:'<div class="tooltip hint" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',html:!0,title:"<strong>Are you sure that this is the right answer?</strong>  Vote to support this correction! <img height='17' src='https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/png/1f64a.png'>",placement:"right",trigger:"manual"}).tooltip("show"),setTimeout(function(){o.find(".check").tooltip("hide")},5e3))}else window.h.skipped_count+=1,choice_pk=null;updateSharedProgressBar(window.SESSION_PK,window.h);var t=window.k.data("question-pk");window.u[t]=choice_pk,controlSessionFinished();var s={session_pk:window.SESSION_PK,question_pk:t,choice_pk:choice_pk};$.ajax({url:Urls["exams:submit_answer"](),type:"POST",data:s,cache:!1,success:function(i){i.success?choice_pk||toastr.warning("You skipped this question"):toastr.error(i.message)}})}}function updateSizes(){var i=$("#container").height()-$("#top-info").height()-$("#top-options").height();$("#question-row").css({"padding-bottom":$("#footer").height(),"min-height":i})}function initializeKeyboard(){$(document).keydown(function(i){if(window.I[i.which]=!0,window.I[37])$("#previous").trigger("click"),_paq.push(["trackEvent","show_session","navigation","keyboard-previous"]);else if(window.I[39]||window.I[32])i.preventDefault(),$("#next").trigger("click"),_paq.push(["trackEvent","show_session","navigation","keyboard-next"]);else if(window.I[18]&&window.I[77])_paq.push(["trackEvent","show_session","mark-question","keyboard-mark"]),window.g.trigger("click");else if(window.I[18]&&window.I[85]){if(_paq.push(["trackEvent","show_session","find-pending","keyboard-pending"]),"SOLVED"==window.SESSION_MODE||"INCOMPLETE"==window.SESSION_MODE)return;var o=$(".question-body[data-was-solved=false]").data("question-sequence");o?showQuestion(o):toastr.success("Yay!  No pending in this session.")}else if(window.I[17]&&window.I[13])_paq.push(["trackEvent","show_session","mark-question","keyboard-submit"]),window.M.trigger("click");else{if(!(window.I[17]&&window.I[38]||window.I[17]&&window.I[40]))return;i.preventDefault();var n=window.k.find(".question-choice").length,e=window.k.find(".question-choice:enabled:checked");if(e.length){var t=window.k.find(".question-choice").index(e);if(window.I[38]&&0==t)return;if(window.I[40]&&t==n-1)return;if(window.I[40]){_paq.push(["trackEvent","show_session","navigation","keyboard-down"]);var s=t+1}else if(window.I[38]){_paq.push(["trackEvent","show_session","navigation","keyboard-up"]);s=t-1}}else s=0;var a=window.k.find(".question-choice:enabled").get(s);$(a).prop("checked",!0).trigger("change")}}),$(document).keyup(function(i){delete window.I[i.which]})}function constructNavigationTable(){$("#navigate-modal").modal({show:!1}),$("#open-navigation").off("click").click(function(){_paq.push(["trackEvent","show_session","navigation","open-navigation"]),$("#navigate-modal").modal("show")}),$("#navigate-modal").on("shown.bs.modal",function(){$(this).animate({scrollTop:$(".navigate-row.table-active").position().top},500)});for(var i=document.getElementById("navigation-tbody"),o="",n=1;n<=window.i.length;n++){var e=SESSION_QUESTION_PKS[n-1],t=void 0!==window.u[e]?window.T:'<i class="far fa-square"></i>';if(window.l)var s=-1!=window.l.indexOf(e)?window._:"";o+="<tr class='navigate-row text-center' data-question-sequence='"+n.toString()+"'><td>"+n.toString()+"</td><td class='d-sm-table-cell d-none'>"+e.toString()+"</td><td class='d-sm-table-cell d-none is_marked'>"+s+"</td><td class='was_solved'>"+t+"</td></tr>"}i.innerHTML=o,isSafari9()&&FontAwesome.dom.i2svg({node:document.getElementById("navigation-table")}),$("#navigation-table").find(".navigate-row").click(function(){_paq.push(["trackEvent","show_session","navigation","click-navigate-row"]),showQuestion($(this).data("question-sequence"))}),highlightActiveRow(),window.p=!0}function fetchAnswers(){$.ajax({method:"get",url:Urls["answer-list"](),data:{format:"json",session_pk:window.SESSION_PK},success:function(i){window.u={},window.h={correct_count:0,incorrect_count:0,skipped_count:0},i.map(function(i){null===i.choice?(window.h.skipped_count+=1,window.u[i.question_id]=null):!0===i.choice.is_right?(window.h.correct_count+=1,window.u[i.question_id]=i.choice.id):!1===i.choice.is_right&&(window.h.incorrect_count+=1,window.u[i.question_id]=i.choice.id)}),prepareQuestions($(".question-body")),controlSessionFinished(),updateSharedProgressBar(window.SESSION_PK,window.h),initializeInteractions(),$("#open-navigation").tooltip("dispose").css("cursor","pointer").click(function(){constructNavigationTable(),$(this).trigger("click")})}})}function fetchMarks(){$.ajax({method:"get",url:Urls["marked-list"](),data:{format:"json",exam_pk:window.EXAM_PK},success:function(i){window.l=i.map(function(i){return i.id}),$(".question-body").each(function(){var i=$(this);applyMark(i,i.data("question-pk"))})}})}function fetchHighlights(){$.ajax({method:"get",url:Urls["highlight-list"](),data:{format:"json",session_pk:window.SESSION_PK},success:function(i){window.s={},i.map(function(i){window.s[i.revision.question_id]={revision_id:i.revision.id,highlighted_text:i.highlighted_text,stricken_choices:i.stricken_choices}}),$(".question-body").each(function(){prepareHighlights($(this))})}})}function fetchSharedStats(){$.ajax({method:"get",url:Urls["exams:get_shared_session_stats"](),data:{format:"json",session_pk:window.SESSION_PK},success:function(i){if(i.success){for(var o in i.stats){var n=i.stats[o];updateSharedProgressBar(n.pk,n)}$('.progress[data-has-finished="false"]').length||clearSharedStatTimer()}else toastr.error(i.message)}})}function updateSharedProgressBar(i,o){if(window.IS_SHARED){var n=$('.progress[data-pk="'+i+'"]');if(i!=window.SESSION_PK?n.attr("data-has-finished",o.has_finished.toString()):i==window.SESSION_PK&&"EXPLAINED"!=window.SESSION_MODE&&(o.count=o.correct_count+o.incorrect_count+o.skipped_count),"EXPLAINED"==window.SESSION_MODE){var e=Math.round(o.correct_count/window.t*100)+"%",t=Math.round(o.incorrect_count/window.t*100)+"%",s=Math.round(o.skipped_count/window.t*100)+"%";n.find(".progress-bar.bg-success").css("width",e).attr("aria-valuenow",o.correct_count),n.find(".progress-bar.bg-danger").css("width",t).attr("aria-valuenow",o.incorrect_count),n.find(".progress-bar.bg-warning").css("width",s).attr("aria-valuenow",o.skipped_count),$("#shared-session-"+i).tooltip({html:!0,title:'<ul class="mb-0 pl-3 sharer-name"><li>Correct: '+o.correct_count+" ("+e+")</li><li>Incorrect: "+o.incorrect_count+" ("+t+")</li><li>Skipped: "+o.skipped_count+" ("+s+")</li></ul>"})}else{var a=o.count/window.t*100+"%";n.find(".progress-bar.bg-success").css("width",a).attr("aria-valuenow",o.count)}}}function isSafari9(){return(-1!=navigator.userAgent.indexOf("iPhone")||-1!=navigator.userAgent.indexOf("iPad"))&&-1!=navigator.userAgent.indexOf("OS 9_")||-1!=navigator.userAgent.indexOf("Mac OS")&&-1!=navigator.userAgent.indexOf("Version/9")&&-1!=navigator.userAgent.indexOf("Safari/")}function fetchList(e,t){if(-1==window.U.indexOf(e)){var s=window.i.slice(e,e+50),a=s.join(",");$("#question-loading").show(),$.ajax({method:"get",url:Urls["exams:list_partial_session_questions"](window.CATEGORY_SLUGS,window.EXAM_PK),data:{pks:a},success:function(i){window.U.push(e);var o=$(i.html);if(-1!=s.indexOf(window.P))var n=o.filter(function(){return $(this).data("question-pk")!=window.P});else n=o;prepareQuestions(n),$("#question-pool").append(n),$.ajax({method:"get",url:Urls["correction-list"](),data:{format:"json",exam_pk:window.EXAM_PK,question_pks:a},success:function(i){$.each(i,function(i,o){updateCorrectionTooltip(o.html,o.choice_id)})}}),isSafari9()&&FontAwesome.dom.i2svg({node:document.getElementById("question-pool")}),t&&showQuestion(t),$("#question-loading").hide()}})}}function prepareHighlights(o){if(null!==window.s){var i=o.data("question-pk"),n=window.s[i];if(void 0!==n)o.data("best-latest-revision-pk")==n.revision_id&&(n.highlighted_text&&o.find(".question-text").html(n.highlighted_text),$.each(n.stricken_choices,function(i){choice_pk=n.stricken_choices[i],o.find("tr[data-choice-pk="+choice_pk+"] .choice-text").addClass("strike")}))}}function prepareChoices(i){if(null!==window.u){var o=i.data("question-pk"),n=window.u[o];if(void 0!==n){if(i.data("was-solved",!0).attr("data-was-solved","true"),i.find(".question-choice").attr("disabled",!0),n)i.find("tr[data-choice-pk="+n+'] input[type="checkbox"]').prop("checked",!0)}else i.data("was-solved",!1).attr("data-was-solved","false");var e,t,s=i.find(".choice-table tbody"),a=s.find("tr"),r=a.length;for(a.detach();0!==r;)t=Math.floor(Math.random()*r),e=a[r-=1],a[r]=a[t],a[t]=e;s.append(a),s.removeClass("unprepared")}}function applyMark(i,o){-1!=window.l.indexOf(o)?(i.data("is-marked",!0).attr("data-is-marked","true"),i.hasClass("show")&&handleMarked(!0)):i.data("is-marked",!1).attr("data-is-marked","false")}function prepareQuestions(i){i.each(function(){var i=$(this),o=i.data("question-pk"),n=i.find(".question-text").html(),e=i.find(".explanation-text").html(),t=converter.makeHtml(n);if(i.find(".question-text").html(t),void 0!==e){var s=converter.makeHtml(e);i.find(".explanation-text").html(s)}prepareChoices(i),prepareHighlights(i);var a=window.i.indexOf(o)+1;i.data("question-sequence",a).attr("data-question-sequence",a);var r=Urls["exams:list_revisions"](window.CATEGORY_SLUGS,window.EXAM_PK,o),c=Urls["exams:show_session"](window.CATEGORY_SLUGS,window.EXAM_PK,window.SESSION_PK,o);i.data("list-revision-url",r).attr("data-list-revision-url",r),i.data("url",c).attr("data-url",c),"SOLVED"!=window.SESSION_MODE&&"INCOMPLETE"!=window.SESSION_MODE||(i.data("was-solved",!0).attr("data-was-solved","true"),i.find(".question-choice").attr("disabled",!0)),window.l&&applyMark(i,o)}),$question_pool=$("#question-pool"),$question_pool.hasClass("choices-were-animated")||($question_pool.addClass("choices-were-animated"),window.k.find("tbody").addClass("animated fadeIn").one(window.q,function(){$(this).removeClass()}))}function setSharedStatTimer(){!window.m&&document.hasFocus()&&$('.progress[data-has-finished="false"]').length&&(window.m=setInterval(fetchSharedStats,5e3))}function clearSharedStatTimer(){window.m&&(clearInterval(window.m),window.m=null)}window.g=$("#mark"),window.M=$("#submit"),window.U=[],window.I={},window.q="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",window.T='<i class="far fa-check-square"></i>',window._='<i class="fas fa-flag"></i>',window.A='<i class="fas fa-times text-danger mx-1"></i>',window.S=null!=navigator.userAgent.match(/iPad/i)||null!=navigator.userAgent.match(/Android/i)&&null==navigator.userAgent.match(/Mobile/i),window.O=null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/Android/i)&&null!=navigator.userAgent.match(/Mobile/i),toastr.options.positionClass="toast-top-left",toastr.options.preventDuplicates=!0,window.onpopstate=function(i){i.state&&showQuestion(i.state.url)},window.S&&($(".mobile-slide").removeClass("d-lg-none"),$("#question-col").removeClass("col-lg-12 px-lg-5")),(window.S||window.O)&&$("#keyboard-hint").addClass("d-none"),window.IS_SHARED&&($(window).on("focus",function(){$('.progress[data-has-finished="false"]').length&&fetchSharedStats(),setSharedStatTimer()}),$(window).on("blur",clearSharedStatTimer)),$(function(){new ClipboardJS("#share-session-copy").on("success",function(i){_paq.push(["trackEvent","show_session","share","click-copy"]),$(i.trigger).tooltip("show"),setTimeout(function(){$(i.trigger).tooltip("hide")},1e3)});var i=$(".question-body.show");window.P=i.data("question-pk");var o=window.i.indexOf(window.P)+1;i.attr("data-question-sequence",o).data("question-sequence",o),showQuestion(o,!0),$("#question-total").html(window.t),$("#question-sequence").html(o),initializeKeyboard(),window.S?$('[data-toggle="tooltip"]').not("#next, #previous, #mark").tooltip():window.O?$('[data-toggle="tooltip"]').not(window.g).tooltip():$('[data-toggle="tooltip"]').tooltip();var n=$("#help-me-tooltip").get(0);$("#help-me").tooltip({html:!0,trigger:"click",title:n}),$("#help-me").click(function(){_paq.push(["trackEvent","show_session","click-get-help","click-get-help"])});var e=$("#setting-tooltip").get(0);$("#settings").tooltip({html:!0,placement:"bottom",trigger:"click",title:e}),$("#settings").click(function(){_paq.push(["trackEvent","show_session","click-settings","click-settings"])});var t=$("#share-tooltip").get(0);$("#share").tooltip({html:!0,trigger:"click",title:t}),$("#share").click(function(){$(this).removeClass("emphasized"),_paq.push(["trackEvent","show_session","share","click-share"])}),$("#theme-select").change(function(){var i=$(this).find("option:selected");$(":root").css({"--primary-background-color":i.data("primary-background-color"),"--secondary-background-color":i.data("secondary-background-color"),"--tertiary-background-color":i.data("tertiary-background-color"),"--primary-font-color":i.data("primary-font-color"),"--secondary-font-color":i.data("secondary-font-color"),"--tertiary-font-color":i.data("tertiary-font-color"),"--highlight-background":i.data("highlight-background"),"--highlight-color":i.data("highlight-color"),"--table-active":i.data("table-active"),"--table-hover":i.data("table-hover")})}),$("#save-theme").click(function(){$.ajax({url:Urls["exams:update_session_theme"](),type:"POST",data:{session_theme_pk:$("#theme-select").val()},success:function(i){i.success?($("#settings").tooltip("hide"),toastr.success("Your theme was updated!")):toastr.error(i.message)}})}),fetchAnswers(),fetchHighlights(),fetchMarks(),updateSizes(),$(window).resize(updateSizes),window.IS_SHARED&&(fetchSharedStats(),setSharedStatTimer()),$(".mobile-slide").click(function(){$(this).hasClass("previous")?($("#previous").trigger("click"),_paq.push(["trackEvent","show_session","navigation","slide-previous"])):$(this).hasClass("next")&&($("#next").trigger("click"),_paq.push(["trackEvent","show_session","navigation","slide-next"]))}),$("#end").click(function(){$("#confirm-end-modal a.submit-button").prop("href",Urls["exams:show_session_results"](window.CATEGORY_SLUGS,window.EXAM_PK,window.SESSION_PK)),$("#confirm-end-modal").modal("show")}),window.M.click(submitChoice),$("#previous, #next").click(navigate),window.g.click(toggleMarked),$(document).tooltip({selector:".answer-correction-notification",html:!0,trigger:"click",title:function(){var i=$(this).closest("td").find(".answer-correction-tooltip-body").clone(!0);return i.find('[data-toggle="tooltip"]').tooltip(),i.get(0)}}),$(document).on("show.bs.tooltip",".answer-correction-notification",function(){$(".answer-correction-notification").not(this).tooltip("hide"),_paq.push(["trackEvent","show_session","answer_correction","click-notification"])}),$(document).on("click",".delete-correction",function(){var o=$(this).data("choice-pk"),i=Urls["exams:delete_correction"]()+"?"+$.param({choice_pk:o}),n="[data-choice-pk="+o+"]",e=window.k.find("tr"+n);e.data("has-correction",!1).attr("data-has-correction","false"),$(".answer-correction-notification").tooltip("hide"),$(this).tooltip("hide"),$.ajax({url:i,type:"POST",success:function(i){1==i.success?(toastr.success("Your correction was removed."),i.correction_html?updateCorrectionTooltip(i.correction_html,o):e.find(".check").html(window.A)):toastr.error(i.message)}})}),$(document).on("click",".support-correction, .oppose-correction",function(){var i=$(this).data("action"),o=$(this).data("choice-pk"),n=Urls["exams:correct_answer"]()+"?"+$.param({choice_pk:o});_paq.push(["trackEvent","show_session","answer_correction","delete-notification"]),$.ajax({url:n,type:"POST",data:{action:i},success:function(i){1==i.success?(toastr.success("Your vote was submitted."),updateCorrectionTooltip(i.correction_html,o)):toastr.error(i.message)}})}),$("#modify-question-modal, #explain-question-modal,#add-mnemonics-modal").modal({keyboard:!1,backdrop:"static",show:!1}),$("#contribute").click(function(){$("#modify-question-modal").modal("show");var i=Urls["exams:contribute_revision"]()+"?"+$.param({question_pk:window.k.data("question-pk")});$("#modify-question-modal .modal-body").load(i)}),$("#explain, a.explain").click(function(){$("#explain-question-modal").modal("show");var i=Urls["exams:contribute_explanation"]()+"?"+$.param({question_pk:window.k.data("question-pk")});$("#explain-question-modal .modal-body").load(i)}),$("#add-mnemonics").click(function(){$("#add-mnemonics-modal").modal("show");var i=Urls["exams:contribute_mnemonics"]()+"?"+$.param({question_pk:window.k.data("question-pk")});$("#add-mnemonics-modal .modal-body").load(i)});var s="#explain-question-modal,#modify-question-modal,#correct-answer-modal,#add-mnemonics-modal";$(s).on("hidden.bs.modal",function(){initializeKeyboard()}),$(s).on("show.bs.modal",function(){$(document).off("keydown keydup")})});
//# sourceMappingURL=show_session.min.js.map