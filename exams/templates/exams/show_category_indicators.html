{% extends 'base_new.html' %}{% load staticfiles bootstrap3 %}
{% block title %}Fudul | {{ category.name }} indicators{% endblock %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'stack/vendors/css/tables/datatable/dataTables.bootstrap4.min.css' %}">
{% endblock %}

{% block header_title %}
<h1>{{ category.name }} indicators</h1>
{% endblock %}

{% block breadcrumb %}
      <li class="breadcrumb-item"><a href="{% url 'index' %}">Home page</a></li>
      <li class="breadcrumb-item"><a href="{% url 'exams:list_category_indicators' %}">Category indicators</a></li>
			{% for parent_category in category.get_parent_categories %}
			<li class="breadcrumb-item"><a href="{% url 'exams:show_category_indicators' parent_category.get_slugs %}">{{ parent_category.name }}</a></li>
			{% endfor %}
			<li class="breadcrumb-item active">{{ category.name }}</li>
{% endblock %}

{% block content %}
<div class="card">
	<div class="card-body">
		<div class="card-block">
				<table class="table table-striped table-bordered datatable dt-responsive">
				    <thead>
				        <tr>
				            <th>Exam name</th>
				            <th>Total questions</th>
				            <th>Incomplete (%)</th>
				            <th>Has no right answer (%)</th>
				            <th>Has pending latest revision (%)</th>
				            <th>Number of Created Sessions</th>
				        </tr>
				    </thead>
				    <tbody>
				       {% for exam in category.exams.all %}
				       {% with total_count=exam.question_set.count %}
				            <tr>
				                <td><a href="{% url 'exams:list_questions' exam.category.get_slugs exam.pk %}">{{ exam.name }}</a></td>
				                <td>{{ total_count }}</td>
				                <td>{{ exam.get_incomplete_questions.count }} ({% widthratio exam.get_incomplete_questions.count total_count 100 %}%)</td>
				                <td>{{ exam.get_unsolved_questions.count }} ({% widthratio exam.get_unsolved_questions.count total_count 100 %}%)</td>
				                <td>{{ exam.get_pending_latest_revisions.count }} ({% widthratio exam.get_pending_latest_revisions.count total_count 100 %}%)</td>
				                <td>{{ exam.get_number_of_created_sessions }}</td>
				            </tr>
				       {% endwith %}
				       {% endfor %}
				    </tbody>
				</table>
		</div><!--card-block-->
	</div><!--card-body-->
</div><!--card-->
{% endblock %}
{% block customscript %}
<script src="{% static 'stack/vendors/js/tables/jquery.dataTables.min.js' %}" type="text/javascript"></script>
<script src="{% static 'stack/vendors/js/tables/datatable/dataTables.bootstrap4.min.js' %}" type="text/javascript"></script>
  <script type="text/javascript">
    $(function(){
       $('.datatable').dataTable({order: [[1, 'desc']]});
    });
    </script>

{% endblock %}
