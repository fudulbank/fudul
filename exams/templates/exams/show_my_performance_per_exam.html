{% extends 'base_new.html' %}{% load staticfiles exam_utils %}

{% block title %}Fudul | My performance in {{ exam.name }} {% endblock %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'stack/vendors/css/tables/datatable/dataTables.bootstrap4.min.css' %}">
<link rel="stylesheet" href="{% static 'stack/vendors/css/charts/chartist.css' %}">
{% endblock %}

{% block header_title %}
<h1>My performance in {{ exam.name }}</h1>
{% endblock %}

{% block breadcrumb %}
      <li class="breadcrumb-item"><a href="{% url 'index' %}">Home page</a></li>
      <li class="breadcrumb-item"><a href="{% url 'exams:show_my_performance' %}">Performance</a></li>
			<li class="breadcrumb-item active">{{ exam.name }}</li>
{% endblock %}

{% block content %}
<div class="card">
	<div class="card-body">
		<div class="card-block">
			<h2>{{ exam.name }} performance</h2>
			<div class="chart-container mb-2" style="height: 300px; width: 400px; max-width: 100%;">
				<canvas id="performance-chart">
			</div>
			<h2>Performance per subject</h2>
			<table style="width: 100%;" class="datatable table table-striped table-bordered dt-responsive">
			  <thead>
			    <tr>
			      <th class="all">Subject</th>
			      <th data-toggle="tooltip" title="Questions that were correctly answered by you at least one time." class="all">Correct</th>
			      <th data-toggle="tooltip" title="Questions that were incorrectly answered by you and never answed correctly.">Incorrect</th>
			      <th data-toggle="tooltip" title="Questions that were shown, skipped and never answered by you.">Skipped</th>
			    </tr>
			  </thead>
			  <tbody>
			    {% for subject in exam.subject_set.all %}
			      <tr>
			        <td>{{ subject.name }}</td>
			        <td data-order="{% get_user_question_stats subject user 'correct' %}" class="text-xs-center">
                <span class="font-small-2">{% get_user_question_stats subject user 'correct' %} ({% get_user_question_stats subject user 'correct' percent=True %}%)</span>
                <progress class="progress progress-sm progress-success mb-0" value="{% get_user_question_stats subject user 'correct' percent=True %}" max="100"></progress>
              </td>
              <td data-order="{% get_user_question_stats subject user 'incorrect' %}" class="text-xs-center">
                <span class="font-small-2">{% get_user_question_stats subject user 'incorrect' %} ({% get_user_question_stats subject user 'incorrect' percent=True %}%)</span>
                <progress class="progress progress-sm progress-danger mb-0" value="{% get_user_question_stats subject user 'incorrect' percent=True %}" max="100"></progress>
              </td>
              <td data-order="{% get_user_question_stats subject user 'skipped' %}" class="text-xs-center">
                <span class="font-small-2">{% get_user_question_stats subject user 'skipped' %} ({% get_user_question_stats subject user 'skipped' percent=True %}%)</span>
                <progress class="progress progress-sm progress-warning mb-0" value="{% get_user_question_stats subject user 'skipped' percent=True %}" max="100"></progress>
              </td>
			      </tr>
			    {% endfor %}
			  </tbody>
			</table>
		</div><!--card-block-->
	</div><!--card-body-->
</div><!--card-->
{% endblock %}
{% block customscript %}
<script src="{% static 'stack/vendors/js/tables/jquery.dataTables.min.js' %}" type="text/javascript"></script>
<script src="{% static 'stack/vendors/js/tables/datatable/dataTables.bootstrap4.min.js' %}" type="text/javascript"></script>
<script src="{% static 'stack/vendors/js/tables/datatable/dataTables.responsive.min.js' %}" type="text/javascript"></script>
<script src="{% static 'stack/vendors/js/charts/chart.min.js' %}"></script>

{% include 'exams/partials/performance_chart.html' %}
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
    $("table.datatable").DataTable({paging: false, info: false});
});
</script>

{% endblock %}
