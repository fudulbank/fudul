{% extends 'base_new.html' %}{% load staticfiles bootstrap3 %}

{% block title %}Fudul | Previous sessions {% endblock %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'stack/vendors/css/tables/datatable/dataTables.bootstrap4.min.css' %}">
{% endblock %}

{% block header_title %}
<h1>Previous sessions</h1>
{% endblock %}

{% block breadcrumb %}
      <li class="breadcrumb-item"><a href="{% url 'index' %}">Home page</a></li>
      <li class="breadcrumb-item"><a href="{% url 'exams:list_meta_categories' %}">Exams</a></li>
      <li class="breadcrumb-item active">Previous sessions</li>
{% endblock %}

{% block content %}
<div class="card">
  <div class="card-body">
    <div class="card-block">
      <p class="alert alert-success"><i class="ft-info"></i> Note that solved sesssions are <strong>not</strong> shown here.</p>
       <table class="table table-striped table-bordered datatable dt-responsive">
          <thead>
            <tr>
              <th data-priority="6">ID</th>
              <th data-priority="1">Exam</th>
              <th data-priority="4"># questions</th>
              <th data-priority="4">Subjects</th>
              <th data-priority="5">Mode</th>
              <th data-priority="2">Score</th>
              <th data-priority="3">Action</th>
            </tr>
          </thead>
          <tbody>
          {% for session in sesstions %}
          <tr>
              <td>{{ session.pk }}</td>
              <td><a href="{% url 'exams:create_session' session.exam.category.get_slugs session.exam.pk %}">{{ session.exam.name }}</a></td>
              <td>{{ session.questions.approved.count }}</td>
          {% if session.subjects.count == 1 %}
              <td>{{ session.subjects.first.name }}</td>
          {% else %}
              <td>Multiple</td>
          {% endif %}
              <td>{{ session.get_session_mode_display }}</td>
          {% if session.has_finished %}
              <td>{{ session.get_score }}%</td>
          {% else %}
              <td>Ongoing</td>
          {% endif %}
          {% if not session.has_finished %}
                  <td> <a href="{% url 'exams:show_session' session.exam.category.get_slugs session.exam.pk session.pk %}">Resume</a></td>
          {% else %}
                  <td><a href="{% url 'exams:show_session_results' session.exam.category.get_slugs session.exam.pk session.pk %}">View results</a></td>
          {% endif %}
            </tr>

          {% endfor %}
          </tbody>
        </table>
    </div><!--card-block-->
  </div><!--card-body-->
</div><!--card-->

{% endblock %}
{% block customscript %}
<script src="{% static 'stack/vendors/js/tables/jquery.dataTables.min.js' %}" type="text/javascript"></script>
<script src="{% static 'stack/vendors/js/tables/datatable/dataTables.bootstrap4.min.js' %}" type="text/javascript"></script>
<script src="{% static 'stack/vendors/js/tables/datatable/dataTables.responsive.min.js' %}" type="text/javascript"></script>

    <script>
    $(function () {
        $(".datatable").DataTable({
            "order": [[ 2, "desc" ]]
        });
    });
    </script>
{% endblock %}
